{"version":3,"names":[],"mappings":"","sources":["page.js"],"sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){\nfunction showSpinner(e){refreshButton.classList.add(\"loading\")}function hideSpinner(e){refreshButton.classList.remove(\"loading\")}function updatePage(e){var t;photoIDsDisplayed?(t=photosEl.scrollHeight,e=e.filter(function(e){return-1==photoIDsDisplayed.indexOf(e.id)?(photoIDsDisplayed.push(e.id),!0):!1}),photosEl.insertBefore(utils.strToEls(photosTemplate(e)),photosEl.firstChild),photosEl.scrollTop+=photosEl.scrollHeight-t):(photoIDsDisplayed=e.map(function(e){return e.id}),photosEl.insertBefore(utils.strToEls(photosTemplate(e)),photosEl.firstChild))}function getTrainPhotoData(){return flickr.search(searchTerm,{headers:{}})[\"catch\"](function(){return null})}function getCachedTrainPhotoData(){return\"serviceWorker\"in navigator&&navigator.serviceWorker.controller?flickr.search(searchTerm,{headers:{\"x-use-cache-only\":\"1\"}})[\"catch\"](function(){return null}):Promise.resolve(null)}function showMessage(e,t){msgContentEl.textContent=e,msgEl.style.display=\"block\",msgEl.offsetWidth,msgEl.classList.add(\"show\"),setTimeout(function(){msgEl.classList.remove(\"show\")},t)}function showConnectionError(){showMessage(\"Connectivity derailed!\",5e3)}window.Promise=window.Promise||require(\"es6-promise\").Promise,require(\"whatwg-fetch\");var flickr=require(\"./flickr\"),photosTemplate=require(\"./views/photos.hbs\"),utils=require(\"./utils\"),searchTerm=\"train station\";location.port&&\"80\"!=location.port||\"https:\"==location.protocol||(location.protocol=\"https:\");var photosEl=document.querySelector(\".photos\"),refreshButton=document.querySelector(\"button.refresh\"),msgEl=document.querySelector(\".msg-container\"),msgContentEl=document.querySelector(\".msg\"),photoIDsDisplayed=null;\"serviceWorker\"in navigator&&(navigator.serviceWorker.register(\"./sw.js\"),navigator.serviceWorker.controller||navigator.serviceWorker.addEventListener(\"controllerchange\",function e(){flickr.search(searchTerm,{headers:{\"x-cache-warmup\":\"1\"}}),navigator.serviceWorker.removeEventListener(\"controllerchange\",e)})),refreshButton.addEventListener(\"click\",function(e){this.blur(),e.preventDefault(),showSpinner(),getTrainPhotoData().then(function(e){var t=photoIDsDisplayed&&photoIDsDisplayed.length;updatePage(e),t!=photoIDsDisplayed.length&&(photosEl.scrollTop=0)})[\"catch\"](showConnectionError).then(hideSpinner)});var liveDataFetched=getTrainPhotoData().then(function(e){if(!e)return!1;var t=!!photoIDsDisplayed,o=photoIDsDisplayed&&photoIDsDisplayed.length;return updatePage(e),t&&o!=photoIDsDisplayed.length&&showMessage(\"▲ New trains ▲\",3e3),!0}),cachedDataFetched=getCachedTrainPhotoData().then(function(e){return e?(photoIDsDisplayed||updatePage(e),!0):!1});liveDataFetched.then(function(e){return e||cachedDataFetched}).then(function(e){e||showConnectionError(),hideSpinner()}),document.addEventListener(\"load\",function(e){e.target.classList.contains(\"main-photo-img\")&&e.target.parentNode.classList.add(\"loaded\")},!0);\n},{\"./flickr\":13,\"./utils\":14,\"./views/photos.hbs\":15,\"es6-promise\":3,\"whatwg-fetch\":12}],2:[function(require,module,exports){\nfunction drainQueue(){if(!draining){draining=!0;for(var e,o=queue.length;o;){e=queue,queue=[];for(var r=-1;++r<o;)e[r]();o=queue.length}draining=!1}}function noop(){}var process=module.exports={},queue=[],draining=!1;process.nextTick=function(e){queue.push(e),draining||setTimeout(drainQueue,0)},process.title=\"browser\",process.browser=!0,process.env={},process.argv=[],process.version=\"\",process.versions={},process.on=noop,process.addListener=noop,process.once=noop,process.off=noop,process.removeListener=noop,process.removeAllListeners=noop,process.emit=noop,process.binding=function(e){throw new Error(\"process.binding is not supported\")},process.cwd=function(){return\"/\"},process.chdir=function(e){throw new Error(\"process.chdir is not supported\")},process.umask=function(){return 0};\n\n\n},{}],3:[function(require,module,exports){\n(function (process,global){\n(function(){\"use strict\";function t(t){return\"function\"==typeof t||\"object\"==typeof t&&null!==t}function e(t){return\"function\"==typeof t}function n(t){return\"object\"==typeof t&&null!==t}function r(){}function o(){return function(){process.nextTick(c)}}function i(){var t=0,e=new F(c),n=document.createTextNode(\"\");return e.observe(n,{characterData:!0}),function(){n.data=t=++t%2}}function s(){var t=new MessageChannel;return t.port1.onmessage=c,function(){t.port2.postMessage(0)}}function u(){return function(){setTimeout(c,1)}}function c(){for(var t=0;D>t;t+=2){var e=N[t],n=N[t+1];e(n),N[t]=void 0,N[t+1]=void 0}D=0}function a(){}function f(){return new TypeError(\"You cannot resolve a promise with itself\")}function l(){return new TypeError(\"A promises callback cannot return that same promise.\")}function h(t){try{return t.then}catch(e){return z.error=e,z}}function p(t,e,n,r){try{t.call(e,n,r)}catch(o){return o}}function _(t,e,n){Y(function(t){var r=!1,o=p(n,e,function(n){r||(r=!0,e!==n?m(t,n):w(t,n))},function(e){r||(r=!0,g(t,e))},\"Settle: \"+(t._label||\" unknown promise\"));!r&&o&&(r=!0,g(t,o))},t)}function d(t,e){e._state===W?w(t,e._result):t._state===q?g(t,e._result):b(e,void 0,function(e){m(t,e)},function(e){g(t,e)})}function v(t,n){if(n.constructor===t.constructor)d(t,n);else{var r=h(n);r===z?g(t,z.error):void 0===r?w(t,n):e(r)?_(t,n,r):w(t,n)}}function m(e,n){e===n?g(e,f()):t(n)?v(e,n):w(e,n)}function y(t){t._onerror&&t._onerror(t._result),A(t)}function w(t,e){t._state===U&&(t._result=e,t._state=W,0===t._subscribers.length||Y(A,t))}function g(t,e){t._state===U&&(t._state=q,t._result=e,Y(y,t))}function b(t,e,n,r){var o=t._subscribers,i=o.length;t._onerror=null,o[i]=e,o[i+W]=n,o[i+q]=r,0===i&&t._state&&Y(A,t)}function A(t){var e=t._subscribers,n=t._state;if(0!==e.length){for(var r,o,i=t._result,s=0;s<e.length;s+=3)r=e[s],o=e[s+n],r?P(n,r,o,i):o(i);t._subscribers.length=0}}function j(){this.error=null}function E(t,e){try{return t(e)}catch(n){return B.error=n,B}}function P(t,n,r,o){var i,s,u,c,a=e(r);if(a){if(i=E(r,o),i===B?(c=!0,s=i.error,i=null):u=!0,n===i)return void g(n,l())}else i=o,u=!0;n._state!==U||(a&&u?m(n,i):c?g(n,s):t===W?w(n,i):t===q&&g(n,i))}function T(t,e){try{e(function(e){m(t,e)},function(e){g(t,e)})}catch(n){g(t,n)}}function S(t,e,n,r){this._instanceConstructor=t,this.promise=new t(a,r),this._abortOnReject=n,this._validateInput(e)?(this._input=e,this.length=e.length,this._remaining=e.length,this._init(),0===this.length?w(this.promise,this._result):(this.length=this.length||0,this._enumerate(),0===this._remaining&&w(this.promise,this._result))):g(this.promise,this._validationError())}function k(){throw new TypeError(\"You must pass a resolver function as the first argument to the promise constructor\")}function M(){throw new TypeError(\"Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.\")}function O(t){this._id=V++,this._state=void 0,this._result=void 0,this._subscribers=[],a!==t&&(e(t)||k(),this instanceof O||M(),T(this,t))}var C;C=Array.isArray?Array.isArray:function(t){return\"[object Array]\"===Object.prototype.toString.call(t)};var R,x=C,D=(Date.now||function(){return(new Date).getTime()},Object.create||function(t){if(arguments.length>1)throw new Error(\"Second argument not supported\");if(\"object\"!=typeof t)throw new TypeError(\"Argument must be an object\");return r.prototype=t,new r},0),Y=function(t,e){N[D]=t,N[D+1]=e,D+=2,2===D&&R()},I=\"undefined\"!=typeof window?window:{},F=I.MutationObserver||I.WebKitMutationObserver,K=\"undefined\"!=typeof Uint8ClampedArray&&\"undefined\"!=typeof importScripts&&\"undefined\"!=typeof MessageChannel,N=new Array(1e3);R=\"undefined\"!=typeof process&&\"[object process]\"==={}.toString.call(process)?o():F?i():K?s():u();var U=void 0,W=1,q=2,z=new j,B=new j;S.prototype._validateInput=function(t){return x(t)},S.prototype._validationError=function(){return new Error(\"Array Methods must be provided an Array\")},S.prototype._init=function(){this._result=new Array(this.length)};var G=S;S.prototype._enumerate=function(){for(var t=this.length,e=this.promise,n=this._input,r=0;e._state===U&&t>r;r++)this._eachEntry(n[r],r)},S.prototype._eachEntry=function(t,e){var r=this._instanceConstructor;n(t)?t.constructor===r&&t._state!==U?(t._onerror=null,this._settledAt(t._state,e,t._result)):this._willSettleAt(r.resolve(t),e):(this._remaining--,this._result[e]=this._makeResult(W,e,t))},S.prototype._settledAt=function(t,e,n){var r=this.promise;r._state===U&&(this._remaining--,this._abortOnReject&&t===q?g(r,n):this._result[e]=this._makeResult(t,e,n)),0===this._remaining&&w(r,this._result)},S.prototype._makeResult=function(t,e,n){return n},S.prototype._willSettleAt=function(t,e){var n=this;b(t,void 0,function(t){n._settledAt(W,e,t)},function(t){n._settledAt(q,e,t)})};var H=function(t,e){return new G(this,t,!0,e).promise},J=function(t,e){function n(t){m(i,t)}function r(t){g(i,t)}var o=this,i=new o(a,e);if(!x(t))return g(i,new TypeError(\"You must pass an array to race.\")),i;for(var s=t.length,u=0;i._state===U&&s>u;u++)b(o.resolve(t[u]),void 0,n,r);return i},L=function(t,e){var n=this;if(t&&\"object\"==typeof t&&t.constructor===n)return t;var r=new n(a,e);return m(r,t),r},Q=function(t,e){var n=this,r=new n(a,e);return g(r,t),r},V=0,X=O;O.all=H,O.race=J,O.resolve=L,O.reject=Q,O.prototype={constructor:O,then:function(t,e){var n=this,r=n._state;if(r===W&&!t||r===q&&!e)return this;var o=new this.constructor(a),i=n._result;if(r){var s=arguments[r-1];Y(function(){P(r,o,s,i)})}else b(n,o,t,e);return o},\"catch\":function(t){return this.then(null,t)}};var Z=function(){var t;t=\"undefined\"!=typeof global?global:\"undefined\"!=typeof window&&window.document?window:self;var n=\"Promise\"in t&&\"resolve\"in t.Promise&&\"reject\"in t.Promise&&\"all\"in t.Promise&&\"race\"in t.Promise&&function(){var n;return new t.Promise(function(t){n=t}),e(n)}();n||(t.Promise=X)},$={Promise:X,polyfill:Z};\"function\"==typeof define&&define.amd?define(function(){return $}):\"undefined\"!=typeof module&&module.exports?module.exports=$:\"undefined\"!=typeof this&&(this.ES6Promise=$)}).call(this);\n\n\n}).call(this,require('_process'),typeof global !== \"undefined\" ? global : typeof self !== \"undefined\" ? self : typeof window !== \"undefined\" ? window : {})\n},{\"_process\":2}],4:[function(require,module,exports){\n(function (global){\n\"use strict\";var base=require(\"./handlebars/base\"),SafeString=require(\"./handlebars/safe-string\")[\"default\"],Exception=require(\"./handlebars/exception\")[\"default\"],Utils=require(\"./handlebars/utils\"),runtime=require(\"./handlebars/runtime\"),create=function(){var e=new base.HandlebarsEnvironment;return Utils.extend(e,base),e.SafeString=SafeString,e.Exception=Exception,e.Utils=Utils,e.escapeExpression=Utils.escapeExpression,e.VM=runtime,e.template=function(a){return runtime.template(a,e)},e},Handlebars=create();Handlebars.create=create;var root=\"undefined\"!=typeof global?global:window,$Handlebars=root.Handlebars;Handlebars.noConflict=function(){root.Handlebars===Handlebars&&(root.Handlebars=$Handlebars)},Handlebars[\"default\"]=Handlebars,exports[\"default\"]=Handlebars;\n\n\n}).call(this,typeof global !== \"undefined\" ? global : typeof self !== \"undefined\" ? self : typeof window !== \"undefined\" ? window : {})\n},{\"./handlebars/base\":5,\"./handlebars/exception\":6,\"./handlebars/runtime\":7,\"./handlebars/safe-string\":8,\"./handlebars/utils\":9}],5:[function(require,module,exports){\n\"use strict\";function HandlebarsEnvironment(e,t){this.helpers=e||{},this.partials=t||{},registerDefaultHelpers(this)}function registerDefaultHelpers(e){e.registerHelper(\"helperMissing\",function(){if(1===arguments.length)return void 0;throw new Exception(\"Missing helper: '\"+arguments[arguments.length-1].name+\"'\")}),e.registerHelper(\"blockHelperMissing\",function(t,r){var n=r.inverse,i=r.fn;if(t===!0)return i(this);if(t===!1||null==t)return n(this);if(isArray(t))return t.length>0?(r.ids&&(r.ids=[r.name]),e.helpers.each(t,r)):n(this);if(r.data&&r.ids){var a=createFrame(r.data);a.contextPath=Utils.appendContextPath(r.data.contextPath,r.name),r={data:a}}return i(t,r)}),e.registerHelper(\"each\",function(e,t){function r(t,r,s){n&&(n.key=t,n.index=r,n.first=0===r,n.last=!!s,i&&(n.contextPath=i+t)),o+=a(e[t],{data:n,blockParams:Utils.blockParams([e[t],t],[i+t,null])})}if(!t)throw new Exception(\"Must pass iterator to #each\");var n,i,a=t.fn,s=t.inverse,l=0,o=\"\";if(t.data&&t.ids&&(i=Utils.appendContextPath(t.data.contextPath,t.ids[0])+\".\"),isFunction(e)&&(e=e.call(this)),t.data&&(n=createFrame(t.data)),e&&\"object\"==typeof e)if(isArray(e))for(var c=e.length;c>l;l++)r(l,l,l===e.length-1);else{var p;for(var h in e)e.hasOwnProperty(h)&&(p&&r(p,l-1),p=h,l++);p&&r(p,l-1,!0)}return 0===l&&(o=s(this)),o}),e.registerHelper(\"if\",function(e,t){return isFunction(e)&&(e=e.call(this)),!t.hash.includeZero&&!e||Utils.isEmpty(e)?t.inverse(this):t.fn(this)}),e.registerHelper(\"unless\",function(t,r){return e.helpers[\"if\"].call(this,t,{fn:r.inverse,inverse:r.fn,hash:r.hash})}),e.registerHelper(\"with\",function(e,t){isFunction(e)&&(e=e.call(this));var r=t.fn;if(Utils.isEmpty(e))return t.inverse(this);if(t.data&&t.ids){var n=createFrame(t.data);n.contextPath=Utils.appendContextPath(t.data.contextPath,t.ids[0]),t={data:n}}return r(e,t)}),e.registerHelper(\"log\",function(t,r){var n=r.data&&null!=r.data.level?parseInt(r.data.level,10):1;e.log(n,t)}),e.registerHelper(\"lookup\",function(e,t){return e&&e[t]})}var Utils=require(\"./utils\"),Exception=require(\"./exception\")[\"default\"],VERSION=\"3.0.1\";exports.VERSION=VERSION;var COMPILER_REVISION=6;exports.COMPILER_REVISION=COMPILER_REVISION;var REVISION_CHANGES={1:\"<= 1.0.rc.2\",2:\"== 1.0.0-rc.3\",3:\"== 1.0.0-rc.4\",4:\"== 1.x.x\",5:\"== 2.0.0-alpha.x\",6:\">= 2.0.0-beta.1\"};exports.REVISION_CHANGES=REVISION_CHANGES;var isArray=Utils.isArray,isFunction=Utils.isFunction,toString=Utils.toString,objectType=\"[object Object]\";exports.HandlebarsEnvironment=HandlebarsEnvironment,HandlebarsEnvironment.prototype={constructor:HandlebarsEnvironment,logger:logger,log:log,registerHelper:function(e,t){if(toString.call(e)===objectType){if(t)throw new Exception(\"Arg not supported with multiple helpers\");Utils.extend(this.helpers,e)}else this.helpers[e]=t},unregisterHelper:function(e){delete this.helpers[e]},registerPartial:function(e,t){if(toString.call(e)===objectType)Utils.extend(this.partials,e);else{if(\"undefined\"==typeof t)throw new Exception(\"Attempting to register a partial as undefined\");this.partials[e]=t}},unregisterPartial:function(e){delete this.partials[e]}};var logger={methodMap:{0:\"debug\",1:\"info\",2:\"warn\",3:\"error\"},DEBUG:0,INFO:1,WARN:2,ERROR:3,level:1,log:function(e,t){if(\"undefined\"!=typeof console&&logger.level<=e){var r=logger.methodMap[e];(console[r]||console.log).call(console,t)}}};exports.logger=logger;var log=logger.log;exports.log=log;var createFrame=function(e){var t=Utils.extend({},e);return t._parent=e,t};exports.createFrame=createFrame;\n\n\n},{\"./exception\":6,\"./utils\":9}],6:[function(require,module,exports){\n\"use strict\";function Exception(r,e){var o,t,s=e&&e.loc;s&&(o=s.start.line,t=s.start.column,r+=\" - \"+o+\":\"+t);for(var n=Error.prototype.constructor.call(this,r),i=0;i<errorProps.length;i++)this[errorProps[i]]=n[errorProps[i]];s&&(this.lineNumber=o,this.column=t)}var errorProps=[\"description\",\"fileName\",\"lineNumber\",\"message\",\"name\",\"number\",\"stack\"];Exception.prototype=new Error,exports[\"default\"]=Exception;\n\n\n},{}],7:[function(require,module,exports){\n\"use strict\";function checkRevision(e){var r=e&&e[0]||1,t=COMPILER_REVISION;if(r!==t){if(t>r){var n=REVISION_CHANGES[t],a=REVISION_CHANGES[r];throw new Exception(\"Template was precompiled with an older version of Handlebars than the current runtime. Please update your precompiler to a newer version (\"+n+\") or downgrade your runtime to an older version (\"+a+\").\")}throw new Exception(\"Template was precompiled with a newer version of Handlebars than the current runtime. Please update your runtime to a newer version (\"+e[1]+\").\")}}function template(e,r){if(!r)throw new Exception(\"No environment passed to template\");if(!e||!e.main)throw new Exception(\"Unknown template object: \"+typeof e);r.VM.checkRevision(e.compiler);var t=function(t,n,a){a.hash&&(n=Utils.extend({},n,a.hash)),t=r.VM.resolvePartial.call(this,t,n,a);var o=r.VM.invokePartial.call(this,t,n,a);if(null==o&&r.compile&&(a.partials[a.name]=r.compile(t,e.compilerOptions,r),o=a.partials[a.name](n,a)),null!=o){if(a.indent){for(var i=o.split(\"\\n\"),p=0,s=i.length;s>p&&(i[p]||p+1!==s);p++)i[p]=a.indent+i[p];o=i.join(\"\\n\")}return o}throw new Exception(\"The partial \"+a.name+\" could not be compiled when running in runtime-only mode\")},n={strict:function(e,r){if(!(r in e))throw new Exception('\"'+r+'\" not defined in '+e);return e[r]},lookup:function(e,r){for(var t=e.length,n=0;t>n;n++)if(e[n]&&null!=e[n][r])return e[n][r]},lambda:function(e,r){return\"function\"==typeof e?e.call(r):e},escapeExpression:Utils.escapeExpression,invokePartial:t,fn:function(r){return e[r]},programs:[],program:function(e,r,t,n,a){var o=this.programs[e],i=this.fn(e);return r||a||n||t?o=program(this,e,i,r,t,n,a):o||(o=this.programs[e]=program(this,e,i)),o},data:function(e,r){for(;e&&r--;)e=e._parent;return e},merge:function(e,r){var t=e||r;return e&&r&&e!==r&&(t=Utils.extend({},r,e)),t},noop:r.VM.noop,compilerInfo:e.compiler},a=function(r,t){t=t||{};var o=t.data;a._setup(t),!t.partial&&e.useData&&(o=initData(r,o));var i,p=e.useBlockParams?[]:void 0;return e.useDepths&&(i=t.depths?[r].concat(t.depths):[r]),e.main.call(n,r,n.helpers,n.partials,o,p,i)};return a.isTop=!0,a._setup=function(t){t.partial?(n.helpers=t.helpers,n.partials=t.partials):(n.helpers=n.merge(t.helpers,r.helpers),e.usePartial&&(n.partials=n.merge(t.partials,r.partials)))},a._child=function(r,t,a,o){if(e.useBlockParams&&!a)throw new Exception(\"must pass block params\");if(e.useDepths&&!o)throw new Exception(\"must pass parent depths\");return program(n,r,e[r],t,0,a,o)},a}function program(e,r,t,n,a,o,i){var p=function(r,a){return a=a||{},t.call(e,r,e.helpers,e.partials,a.data||n,o&&[a.blockParams].concat(o),i&&[r].concat(i))};return p.program=r,p.depth=i?i.length:0,p.blockParams=a||0,p}function resolvePartial(e,r,t){return e?e.call||t.name||(t.name=e,e=t.partials[e]):e=t.partials[t.name],e}function invokePartial(e,r,t){if(t.partial=!0,void 0===e)throw new Exception(\"The partial \"+t.name+\" could not be found\");return e instanceof Function?e(r,t):void 0}function noop(){return\"\"}function initData(e,r){return r&&\"root\"in r||(r=r?createFrame(r):{},r.root=e),r}var Utils=require(\"./utils\"),Exception=require(\"./exception\")[\"default\"],COMPILER_REVISION=require(\"./base\").COMPILER_REVISION,REVISION_CHANGES=require(\"./base\").REVISION_CHANGES,createFrame=require(\"./base\").createFrame;exports.checkRevision=checkRevision,exports.template=template,exports.program=program,exports.resolvePartial=resolvePartial,exports.invokePartial=invokePartial,exports.noop=noop;\n\n\n},{\"./base\":5,\"./exception\":6,\"./utils\":9}],8:[function(require,module,exports){\n\"use strict\";function SafeString(t){this.string=t}SafeString.prototype.toString=SafeString.prototype.toHTML=function(){return\"\"+this.string},exports[\"default\"]=SafeString;\n\n\n},{}],9:[function(require,module,exports){\n\"use strict\";function escapeChar(t){return escape[t]}function extend(t){for(var r=1;r<arguments.length;r++)for(var n in arguments[r])Object.prototype.hasOwnProperty.call(arguments[r],n)&&(t[n]=arguments[r][n]);return t}function indexOf(t,r){for(var n=0,e=t.length;e>n;n++)if(t[n]===r)return n;return-1}function escapeExpression(t){if(\"string\"!=typeof t){if(t&&t.toHTML)return t.toHTML();if(null==t)return\"\";if(!t)return t+\"\";t=\"\"+t}return possible.test(t)?t.replace(badChars,escapeChar):t}function isEmpty(t){return t||0===t?isArray(t)&&0===t.length?!0:!1:!0}function blockParams(t,r){return t.path=r,t}function appendContextPath(t,r){return(t?t+\".\":\"\")+r}var escape={\"&\":\"&amp;\",\"<\":\"&lt;\",\">\":\"&gt;\",'\"':\"&quot;\",\"'\":\"&#x27;\",\"`\":\"&#x60;\"},badChars=/[&<>\"'`]/g,possible=/[&<>\"'`]/;exports.extend=extend;var toString=Object.prototype.toString;exports.toString=toString;var isFunction=function(t){return\"function\"==typeof t};isFunction(/x/)&&(isFunction=function(t){return\"function\"==typeof t&&\"[object Function]\"===toString.call(t)});var isFunction;exports.isFunction=isFunction;var isArray=Array.isArray||function(t){return t&&\"object\"==typeof t?\"[object Array]\"===toString.call(t):!1};exports.isArray=isArray,exports.indexOf=indexOf,exports.escapeExpression=escapeExpression,exports.isEmpty=isEmpty,exports.blockParams=blockParams,exports.appendContextPath=appendContextPath;\n\n\n},{}],10:[function(require,module,exports){\nmodule.exports=require(\"./dist/cjs/handlebars.runtime\")[\"default\"];\n\n\n},{\"./dist/cjs/handlebars.runtime\":4}],11:[function(require,module,exports){\nmodule.exports=require(\"handlebars/runtime\")[\"default\"];\n\n\n},{\"handlebars/runtime\":10}],12:[function(require,module,exports){\n!function(){\"use strict\";function t(e){this.map={};var o=this;e instanceof t?e.forEach(function(t,e){e.forEach(function(e){o.append(t,e)})}):e&&Object.getOwnPropertyNames(e).forEach(function(t){o.append(t,e[t])})}function e(t){return t.bodyUsed?Promise.reject(new TypeError(\"Already read\")):void(t.bodyUsed=!0)}function o(t){return new Promise(function(e,o){t.onload=function(){e(t.result)},t.onerror=function(){o(t.error)}})}function r(t){var e=new FileReader;return e.readAsArrayBuffer(t),o(e)}function n(t){var e=new FileReader;return e.readAsText(t),o(e)}function s(){return this.bodyUsed=!1,d.blob?(this._initBody=function(t){if(this._bodyInit=t,\"string\"==typeof t)this._bodyText=t;else if(d.blob&&Blob.prototype.isPrototypeOf(t))this._bodyBlob=t;else if(d.formData&&FormData.prototype.isPrototypeOf(t))this._bodyFormData=t;else{if(t)throw new Error(\"unsupported BodyInit type\");this._bodyText=\"\"}},this.blob=function(){var t=e(this);if(t)return t;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyFormData)throw new Error(\"could not read FormData body as blob\");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this.blob().then(r)},this.text=function(){var t=e(this);if(t)return t;if(this._bodyBlob)return n(this._bodyBlob);if(this._bodyFormData)throw new Error(\"could not read FormData body as text\");return Promise.resolve(this._bodyText)}):(this._initBody=function(t){if(this._bodyInit=t,\"string\"==typeof t)this._bodyText=t;else if(d.formData&&FormData.prototype.isPrototypeOf(t))this._bodyFormData=t;else{if(t)throw new Error(\"unsupported BodyInit type\");this._bodyText=\"\"}},this.text=function(){var t=e(this);return t?t:Promise.resolve(this._bodyText)}),d.formData&&(this.formData=function(){return this.text().then(u)}),this.json=function(){return this.text().then(JSON.parse)},this}function i(t){var e=t.toUpperCase();return p.indexOf(e)>-1?e:t}function a(e,o){if(o=o||{},this.url=e,this.credentials=o.credentials||\"omit\",this.headers=new t(o.headers),this.method=i(o.method||\"GET\"),this.mode=o.mode||null,this.referrer=null,(\"GET\"===this.method||\"HEAD\"===this.method)&&o.body)throw new TypeError(\"Body not allowed for GET or HEAD requests\");this._initBody(o.body)}function u(t){var e=new FormData;return t.trim().split(\"&\").forEach(function(t){if(t){var o=t.split(\"=\"),r=o.shift().replace(/\\+/g,\" \"),n=o.join(\"=\").replace(/\\+/g,\" \");e.append(decodeURIComponent(r),decodeURIComponent(n))}}),e}function f(e){var o=new t,r=e.getAllResponseHeaders().trim().split(\"\\n\");return r.forEach(function(t){var e=t.trim().split(\":\"),r=e.shift().trim(),n=e.join(\":\").trim();o.append(r,n)}),o}function h(t,e){e||(e={}),this._initBody(t),this.type=\"default\",this.url=null,this.status=e.status,this.statusText=e.statusText,this.headers=e.headers,this.url=e.url||\"\"}if(!self.fetch){t.prototype.append=function(t,e){t=t.toLowerCase();var o=this.map[t];o||(o=[],this.map[t]=o),o.push(e)},t.prototype[\"delete\"]=function(t){delete this.map[t.toLowerCase()]},t.prototype.get=function(t){var e=this.map[t.toLowerCase()];return e?e[0]:null},t.prototype.getAll=function(t){return this.map[t.toLowerCase()]||[]},t.prototype.has=function(t){return this.map.hasOwnProperty(t.toLowerCase())},t.prototype.set=function(t,e){this.map[t.toLowerCase()]=[e]},t.prototype.forEach=function(t){var e=this;Object.getOwnPropertyNames(this.map).forEach(function(o){t(o,e.map[o])})};var d={blob:\"FileReader\"in self&&\"Blob\"in self&&function(){try{return new Blob,!0}catch(t){return!1}}(),formData:\"FormData\"in self},p=[\"DELETE\",\"GET\",\"HEAD\",\"OPTIONS\",\"POST\",\"PUT\"];a.prototype.fetch=function(){var t=this;return new Promise(function(e,o){function r(){return\"responseURL\"in n?n.responseURL:/^X-Request-URL:/m.test(n.getAllResponseHeaders())?n.getResponseHeader(\"X-Request-URL\"):void 0}var n=new XMLHttpRequest;\"cors\"===t.credentials&&(n.withCredentials=!0),n.onload=function(){var t=1223===n.status?204:n.status;if(100>t||t>599)return void o(new TypeError(\"Network request failed\"));var s={status:t,statusText:n.statusText,headers:f(n),url:r()},i=\"response\"in n?n.response:n.responseText;e(new h(i,s))},n.onerror=function(){o(new TypeError(\"Network request failed\"))},n.open(t.method,t.url,!0),\"responseType\"in n&&d.blob&&(n.responseType=\"blob\"),t.headers.forEach(function(t,e){e.forEach(function(e){n.setRequestHeader(t,e)})}),n.send(\"undefined\"==typeof t._bodyInit?null:t._bodyInit)})},s.call(a.prototype),s.call(h.prototype),self.Headers=t,self.Request=a,self.Response=h,self.fetch=function(t,e){return new a(t,e).fetch()},self.fetch.polyfill=!0}}();\n\n\n},{}],13:[function(require,module,exports){\nfunction search(t,r){var e={method:\"flickr.photos.search\",extras:\"description\",format:\"json\",api_key:apiKey,text:t,license:\"4,5,6,7\",content_type:1,nojsoncallback:1,per_page:10};return fetch(apiUrl+\"?\"+utils.toQuerystring(e),r).then(function(t){return t.json()}).then(function(t){if(\"fail\"==t.stat)throw Error(t.err.msg);return t.photos.photo.sort(function(t,r){return r.id-t.id}).map(function(t){return{id:t.id,title:t.title,flickrUrl:\"https://www.flickr.com/photos/\"+t.owner+\"/\"+t.id+\"/\",imgUrl:\"https://farm\"+t.farm+\".staticflickr.com/\"+t.server+\"/\"+t.id+\"_\"+t.secret+\"_c.jpg\",description:t.description._content.trim()}})})}var utils=require(\"./utils\"),apiKey=\"f2cca7d09b75c6cdea6864aca72e9895\",apiUrl=\"https://api.flickr.com/services/rest/\";module.exports.search=search;\n\n\n},{\"./utils\":14}],14:[function(require,module,exports){\nfunction defaults(r,e){var n=Object.create(e);if(!r)return n;for(var t in r)r.hasOwnProperty(t)&&(n[t]=r[t]);return n}function toQuerystring(r){var e=[];for(var n in r)r.hasOwnProperty(n)&&e.push(encodeURIComponent(n)+\"=\"+encodeURIComponent(r[n]));return e.join(\"&\")}var strToEls=function(){var r=document.createElement(\"div\");return function(e){var n=document.createDocumentFragment();for(r.innerHTML=e;r.childNodes[0];)n.appendChild(r.childNodes[0]);return n}}();module.exports={defaults:defaults,toQuerystring:toQuerystring,strToEls:strToEls};\n\n\n},{}],15:[function(require,module,exports){\nvar HandlebarsCompiler=require(\"hbsfy/runtime\");module.exports=HandlebarsCompiler.template({1:function(n,a,l,e){var i,s,t=a.helperMissing,r=\"function\",o=this.escapeExpression;return'  <article class=\"photo\">\\n    <h1>\\n      <a href=\"'+o((s=null!=(s=a.flickrUrl||(null!=n?n.flickrUrl:n))?s:t,typeof s===r?s.call(n,{name:\"flickrUrl\",hash:{},data:e}):s))+'\">\\n        <span class=\"main-photo\">\\n          <span class=\"photo-fader\">\\n            <img src=\"'+o((s=null!=(s=a.imgUrl||(null!=n?n.imgUrl:n))?s:t,typeof s===r?s.call(n,{name:\"imgUrl\",hash:{},data:e}):s))+'\" alt=\"\" class=\"main-photo-img\">\\n          </span>\\n        </span>\\n        <span class=\"title\">'+o((s=null!=(s=a.title||(null!=n?n.title:n))?s:t,typeof s===r?s.call(n,{name:\"title\",hash:{},data:e}):s))+\"</span>\\n      </a>\\n    </h1>\\n\"+(null!=(i=a[\"if\"].call(n,null!=n?n.description:n,{name:\"if\",hash:{},fn:this.program(2,e,0),inverse:this.noop,data:e}))?i:\"\")+\"  </article>\\n\"},2:function(n,a,l,e){var i,s;return'      <p class=\"description\">'+(null!=(s=null!=(s=a.description||(null!=n?n.description:n))?s:a.helperMissing,i=\"function\"==typeof s?s.call(n,{name:\"description\",hash:{},data:e}):s)?i:\"\")+\"</p>\\n\"},compiler:[6,\">= 2.0.0-beta.1\"],main:function(n,a,l,e){var i;return null!=(i=a.each.call(n,n,{name:\"each\",hash:{},fn:this.program(1,e,0),inverse:this.noop,data:e}))?i:\"\"},useData:!0});\n\n\n},{\"hbsfy/runtime\":11}]},{},[1]);\n"],"file":"page.js","sourceRoot":"/source/"}